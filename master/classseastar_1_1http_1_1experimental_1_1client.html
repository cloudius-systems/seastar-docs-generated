<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Seastar: seastar::http::experimental::client Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Seastar
   </div>
   <div id="projectbrief">High performance C++ framework for concurrent servers</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceseastar.html">seastar</a></li><li class="navelem"><b>http</b></li><li class="navelem"><b>experimental</b></li><li class="navelem"><a class="el" href="classseastar_1_1http_1_1experimental_1_1client.html">client</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classseastar_1_1http_1_1experimental_1_1client-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">seastar::http::experimental::client Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class client wraps communications using HTTP protocol. </p>
<p>The class allows making HTTP requests and handling replies. It's up to the caller to provide a transport, though for simple cases the class provides out-of-the-box facilities.</p>
<p>The main benefit client provides against <a class="el" href="classseastar_1_1http_1_1experimental_1_1connection.html">connection</a> is the transparent support for Keep-Alive transport sockets. </p>
</div>
<p><code>#include &lt;<a class="el" href="client_8hh_source.html">seastar/http/client.hh</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a2f3f05b5e0509dc072e3291b70353393"><td class="memItemLeft" align="right" valign="top"><a id="a2f3f05b5e0509dc072e3291b70353393"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>reply_handler</b> = <a class="el" href="namespaceseastar.html#classseastar_1_1noncopyable__function">noncopyable_function</a>&lt; <a class="el" href="classseastar_1_1future.html">future</a>&lt;&gt;(const <a class="el" href="structseastar_1_1http_1_1reply.html">reply</a> &amp;, <a class="el" href="classseastar_1_1input__stream.html">input_stream</a>&lt; char &gt; &amp;&amp;body)&gt;</td></tr>
<tr class="separator:a2f3f05b5e0509dc072e3291b70353393"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aefce59137008916b52fa8fdf792741c3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classseastar_1_1http_1_1experimental_1_1client.html#aefce59137008916b52fa8fdf792741c3">client</a> (<a class="el" href="classseastar_1_1socket__address.html">socket_address</a> addr)</td></tr>
<tr class="memdesc:aefce59137008916b52fa8fdf792741c3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a simple client.  <a href="classseastar_1_1http_1_1experimental_1_1client.html#aefce59137008916b52fa8fdf792741c3">More...</a><br /></td></tr>
<tr class="separator:aefce59137008916b52fa8fdf792741c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9ec73c8a3a49466683ad7e0d0f6a831"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classseastar_1_1http_1_1experimental_1_1client.html#ac9ec73c8a3a49466683ad7e0d0f6a831">client</a> (<a class="el" href="classseastar_1_1socket__address.html">socket_address</a> addr, <a class="el" href="classseastar_1_1shared__ptr.html">shared_ptr</a>&lt; <a class="el" href="classseastar_1_1tls_1_1certificate__credentials.html">tls::certificate_credentials</a> &gt; creds, sstring host={})</td></tr>
<tr class="memdesc:ac9ec73c8a3a49466683ad7e0d0f6a831"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a secure client.  <a href="classseastar_1_1http_1_1experimental_1_1client.html#ac9ec73c8a3a49466683ad7e0d0f6a831">More...</a><br /></td></tr>
<tr class="separator:ac9ec73c8a3a49466683ad7e0d0f6a831"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f831bf9edc7791c5092fa27db8ceddf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classseastar_1_1http_1_1experimental_1_1client.html#a9f831bf9edc7791c5092fa27db8ceddf">client</a> (std::unique_ptr&lt; <a class="el" href="classseastar_1_1http_1_1experimental_1_1connection__factory.html">connection_factory</a> &gt; f, unsigned max_connections=default_max_connections)</td></tr>
<tr class="memdesc:a9f831bf9edc7791c5092fa27db8ceddf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a client with connection factory.  <a href="classseastar_1_1http_1_1experimental_1_1client.html#a9f831bf9edc7791c5092fa27db8ceddf">More...</a><br /></td></tr>
<tr class="separator:a9f831bf9edc7791c5092fa27db8ceddf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f2cf52ff13609e6eea037b1b4847c16"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classseastar_1_1future.html">future</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classseastar_1_1http_1_1experimental_1_1client.html#a3f2cf52ff13609e6eea037b1b4847c16">make_request</a> (<a class="el" href="structseastar_1_1http_1_1request.html">request</a> req, <a class="el" href="namespaceseastar.html#classseastar_1_1noncopyable__function">reply_handler</a> handle, std::optional&lt; <a class="el" href="structseastar_1_1http_1_1reply.html#a936edc91a0e30d78a43fc0203e0529ab">reply::status_type</a> &gt; expected=std::nullopt)</td></tr>
<tr class="memdesc:a3f2cf52ff13609e6eea037b1b4847c16"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send the request and handle the response.  <a href="classseastar_1_1http_1_1experimental_1_1client.html#a3f2cf52ff13609e6eea037b1b4847c16">More...</a><br /></td></tr>
<tr class="separator:a3f2cf52ff13609e6eea037b1b4847c16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69d4cd7e4582799cd013c9a34f64f5e0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classseastar_1_1future.html">future</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classseastar_1_1http_1_1experimental_1_1client.html#a69d4cd7e4582799cd013c9a34f64f5e0">set_maximum_connections</a> (unsigned nr)</td></tr>
<tr class="memdesc:a69d4cd7e4582799cd013c9a34f64f5e0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates the maximum number of connections a client may have.  <a href="classseastar_1_1http_1_1experimental_1_1client.html#a69d4cd7e4582799cd013c9a34f64f5e0">More...</a><br /></td></tr>
<tr class="separator:a69d4cd7e4582799cd013c9a34f64f5e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67d8a89b11ff9994fa4cb7d55c847f8d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classseastar_1_1future.html">future</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classseastar_1_1http_1_1experimental_1_1client.html#a67d8a89b11ff9994fa4cb7d55c847f8d">close</a> ()</td></tr>
<tr class="memdesc:a67d8a89b11ff9994fa4cb7d55c847f8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes the client.  <a href="classseastar_1_1http_1_1experimental_1_1client.html#a67d8a89b11ff9994fa4cb7d55c847f8d">More...</a><br /></td></tr>
<tr class="separator:a67d8a89b11ff9994fa4cb7d55c847f8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53e814c99560e6b9558f8a3226e1ce0e"><td class="memItemLeft" align="right" valign="top"><a id="a53e814c99560e6b9558f8a3226e1ce0e"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classseastar_1_1http_1_1experimental_1_1client.html#a53e814c99560e6b9558f8a3226e1ce0e">connections_nr</a> () const noexcept</td></tr>
<tr class="memdesc:a53e814c99560e6b9558f8a3226e1ce0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the total number of connections. <br /></td></tr>
<tr class="separator:a53e814c99560e6b9558f8a3226e1ce0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ccc7e4fa961d76893913af74c23ab6b"><td class="memItemLeft" align="right" valign="top"><a id="a1ccc7e4fa961d76893913af74c23ab6b"></a>
unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classseastar_1_1http_1_1experimental_1_1client.html#a1ccc7e4fa961d76893913af74c23ab6b">idle_connections_nr</a> () const noexcept</td></tr>
<tr class="memdesc:a1ccc7e4fa961d76893913af74c23ab6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the number of idle connections. <br /></td></tr>
<tr class="separator:a1ccc7e4fa961d76893913af74c23ab6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f94d20012e4d3b527fcbbe3fef106a6"><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classseastar_1_1http_1_1experimental_1_1client.html#a4f94d20012e4d3b527fcbbe3fef106a6">total_new_connections_nr</a> () const noexcept</td></tr>
<tr class="memdesc:a4f94d20012e4d3b527fcbbe3fef106a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the total number of connection factory invocations made so far.  <a href="classseastar_1_1http_1_1experimental_1_1client.html#a4f94d20012e4d3b527fcbbe3fef106a6">More...</a><br /></td></tr>
<tr class="separator:a4f94d20012e4d3b527fcbbe3fef106a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aefce59137008916b52fa8fdf792741c3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefce59137008916b52fa8fdf792741c3">&#9670;&nbsp;</a></span>client() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">seastar::http::experimental::client::client </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classseastar_1_1socket__address.html">socket_address</a>&#160;</td>
          <td class="paramname"><em>addr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct a simple client. </p>
<p>This creates a simple client that connects to provided address via plain (non-TLS) socket</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>&ndash; host address to connect to </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ac9ec73c8a3a49466683ad7e0d0f6a831"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9ec73c8a3a49466683ad7e0d0f6a831">&#9670;&nbsp;</a></span>client() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">seastar::http::experimental::client::client </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classseastar_1_1socket__address.html">socket_address</a>&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classseastar_1_1shared__ptr.html">shared_ptr</a>&lt; <a class="el" href="classseastar_1_1tls_1_1certificate__credentials.html">tls::certificate_credentials</a> &gt;&#160;</td>
          <td class="paramname"><em>creds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">sstring&#160;</td>
          <td class="paramname"><em>host</em> = <code>{}</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Construct a secure client. </p>
<p>This creates a client that connects to provided address via TLS socket with given credentials. In simple words &ndash; this makes an HTTPS client</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">addr</td><td>&ndash; host address to connect to </td></tr>
    <tr><td class="paramname">creds</td><td>&ndash; credentials </td></tr>
    <tr><td class="paramname">host</td><td>&ndash; optional host name </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a9f831bf9edc7791c5092fa27db8ceddf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f831bf9edc7791c5092fa27db8ceddf">&#9670;&nbsp;</a></span>client() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">seastar::http::experimental::client::client </td>
          <td>(</td>
          <td class="paramtype">std::unique_ptr&lt; <a class="el" href="classseastar_1_1http_1_1experimental_1_1connection__factory.html">connection_factory</a> &gt;&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>max_connections</em> = <code>default_max_connections</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct a client with connection factory. </p>
<p>This creates a client that uses factory to get <a class="el" href="classseastar_1_1connected__socket.html">connected_socket</a> that is then used as transport. The client may withdraw more than one socket from the factory and may re-use the sockets on its own</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>&ndash; the factory pointer </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a67d8a89b11ff9994fa4cb7d55c847f8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67d8a89b11ff9994fa4cb7d55c847f8d">&#9670;&nbsp;</a></span>close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classseastar_1_1future.html">future</a> seastar::http::experimental::client::close </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes the client. </p>
<p>Client must be closed before destruction unconditionally </p>

</div>
</div>
<a id="a3f2cf52ff13609e6eea037b1b4847c16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f2cf52ff13609e6eea037b1b4847c16">&#9670;&nbsp;</a></span>make_request()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classseastar_1_1future.html">future</a> seastar::http::experimental::client::make_request </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structseastar_1_1http_1_1request.html">request</a>&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceseastar.html#classseastar_1_1noncopyable__function">reply_handler</a>&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::optional&lt; <a class="el" href="structseastar_1_1http_1_1reply.html#a936edc91a0e30d78a43fc0203e0529ab">reply::status_type</a> &gt;&#160;</td>
          <td class="paramname"><em>expected</em> = <code>std::nullopt</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send the request and handle the response. </p>
<p>Sends the provided request to the server and calls the provided callback to handle the response when it arrives. If the expected status is specified and the response's status is not the expected one, the handler is not called and the method resolves with exceptional future. Otherwise returns the handler's future</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">req</td><td>&ndash; request to be sent </td></tr>
    <tr><td class="paramname">handle</td><td>&ndash; the response handler </td></tr>
    <tr><td class="paramname">expected</td><td>&ndash; the optional expected reply status code, default is std::nullopt </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a69d4cd7e4582799cd013c9a34f64f5e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69d4cd7e4582799cd013c9a34f64f5e0">&#9670;&nbsp;</a></span>set_maximum_connections()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classseastar_1_1future.html">future</a> seastar::http::experimental::client::set_maximum_connections </td>
          <td>(</td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>nr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Updates the maximum number of connections a client may have. </p>
<p>If the new limit is less than the amount of connections a client has, they will be closed. The returned future resolves when all excessive connections get closed</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nr</td><td>&ndash; the new limit on the number of connections </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a4f94d20012e4d3b527fcbbe3fef106a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f94d20012e4d3b527fcbbe3fef106a6">&#9670;&nbsp;</a></span>total_new_connections_nr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long seastar::http::experimental::client::total_new_connections_nr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the total number of connection factory invocations made so far. </p>
<p>This is the monotonically-increasing counter describing how "frequently" the client kicks its factory for new connections. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>seastar/http/<a class="el" href="client_8hh_source.html">client.hh</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
