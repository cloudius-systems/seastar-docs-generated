<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Seastar: Compatibility</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Seastar
   </div>
   <div id="projectbrief">High performance C++ framework for concurrent servers</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Compatibility </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>As a library, Seastar aims to maintain backwards compatibility in terms of the source (application code should continue to build with newer versions of Seastar) and any binary protocols that Seastar exposes (e.g. rpc).</p>
<p>Link compatibility is not maintained - you cannot link an application built with one version of Seastar with another version of Seastar.</p>
<h1><a class="anchor" id="autotoc_md43"></a>
Language standards</h1>
<p>Seastar will support the last two standards approved by the ISO C++ committee. For example, after C++20 is released, Seastar supports C++17 and C++20. Similarly, when C++23 is released, Seastar will support C++20 and C++23.</p>
<p>Some features may only be enabled for newer dialects.</p>
<h1><a class="anchor" id="autotoc_md44"></a>
Platforms</h1>
<p>Seastar supports Linux. There is no known minimum kernel version, but very old kernels might not work. Performance can be significantly better for newer kernels.</p>
<p>Filesystem implementation quality can have significant effect on file I/O performance. XFS is known to be working, ext4 may work well too. Test your filesystem and kernel versions to be sure.</p>
<p>Patches for new platforms (e.g, Windows) are welcome.</p>
<h1><a class="anchor" id="autotoc_md45"></a>
Compilers</h1>
<p>Seastar supports gcc and clang. Ports to other compilers are welcome.</p>
<p>The last two major releases of a compiler are supported (e.g. gcc 11 and gcc 12). Patches to support older versions are welcome, as long as they don't require onerous compromises.</p>
<h1><a class="anchor" id="autotoc_md46"></a>
Deprecation</h1>
<p>Occasionally, we discover that we took the wrong approach with an API. In these cases we will offer a new API and tag the old API with the [[deprecated]] attribute. The deprecated API will be removed after a transition period (which can vary depending on how central the deprecated API is).</p>
<h1><a class="anchor" id="autotoc_md47"></a>
Breaking changes</h1>
<p>Rarely, we have to make breaking changes. We try to limit those, but sometimes there is no choice.</p>
<p>To support a transition period for breaking changes, Seastar offers the Seastar_API_LEVEL cmake variable (and corresponding &ndash;api-level configure.py option). An API level selects different versions of the API. For example.</p>
<ul>
<li>Seastar_API_LEVEL=1 selects an old version of the server_socket::accept() API that returns a variadic future (which is deprecated)</li>
<li>Seastar_API_LEVEL=2 selects a new version of the server_socket::accept() API that returns a non-variadic future</li>
<li>Seastar_API_LEVEL=6 makes futures non-variadic</li>
<li>Seastar_API_LEVEL=7 unifies CPU scheduling groups and IO priority classes "while at it" file_impl API is forced to accept io_intent argument</li>
</ul>
<p>Applications can use an old API_LEVEL during a transition period, fix their code, and move to the new API_LEVEL.</p>
<p>Old API levels only live for a transition period, so if you are using an API level below the latest, you should upgrade quickly.</p>
<p>Note the application should not refer to the <code>api_vN</code> sub-namespaces that Seastar defines as part of the API_LEVEL mechanism; these are internal.</p>
<h1><a class="anchor" id="autotoc_md48"></a>
Internal namespace</h1>
<p>Identifiers in the <code>seastar::internal</code> namespace are not subject to source level compatibility and are subject to change or removal without notice. In addition the <code>api_vN</code> sub-namespaces are also internal.</p>
<h1><a class="anchor" id="autotoc_md49"></a>
Accidentally exposed internal identifiers</h1>
<p>Some identifiers predate the internal namespace, and are only exposed accidentally. These can also be removed or changed. Exposed identifiers are documented using doxygen, but not all exposed APIs are documented. In case of doubt, ask on the mailing list.</p>
<h1><a class="anchor" id="autotoc_md50"></a>
API Level History</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Level   </th><th class="markdownTableHeadCenter">Introduced   </th><th class="markdownTableHeadCenter">Mandatory   </th><th class="markdownTableHeadNone">Description    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">2   </td><td class="markdownTableBodyCenter">2019-07   </td><td class="markdownTableBodyCenter">2020-04   </td><td class="markdownTableBodyNone">Non-variadic futures in socket::accept()    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">3   </td><td class="markdownTableBodyCenter">2020-05   </td><td class="markdownTableBodyCenter">2023-03   </td><td class="markdownTableBodyNone"><a class="el" href="namespaceseastar.html#ae0c59287bb66d284c612ddd4dfb07d30">make_file_data_sink()</a> closes file and returns a <a class="el" href="classseastar_1_1future.html">future&lt;&gt;</a>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">4   </td><td class="markdownTableBodyCenter">2020-06   </td><td class="markdownTableBodyCenter">2023-03   </td><td class="markdownTableBodyNone">Non-variadic futures in <a class="el" href="group__future-util.html#ga38a94c0a3e1ed93ff40960f985565053">when_all_succeed()</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">5   </td><td class="markdownTableBodyCenter">2020-08   </td><td class="markdownTableBodyCenter">2023-03   </td><td class="markdownTableBodyNone">future::get() returns std::monostate() instead of void    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">6   </td><td class="markdownTableBodyCenter">2020-09   </td><td class="markdownTableBodyCenter">2023-03   </td><td class="markdownTableBodyNone">future&lt;T&gt; instead of <a class="el" href="classseastar_1_1future.html">future&lt;T...&gt;</a>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">7   </td><td class="markdownTableBodyCenter">2023-05   </td><td class="markdownTableBodyCenter"></td><td class="markdownTableBodyNone">unified CPU/IO scheduling groups   </td></tr>
</table>
<p>Note: The "mandatory" column indicates when backwards compatibility support for the API preceding the new level was removed.</p>
<h1><a class="anchor" id="autotoc_md51"></a>
Implementation notes for API levels</h1>
<p>API levels are implemented by defining internal sub-namespaces for each API level: <code>seastar::api_v1</code>, <code>seatar::api_v2</code> etc. <code>#ifdef</code>s are used to inline the user-selected API level namespace into the main <code>seastar</code> namespace, making it visible.</p>
<p>Usually, the old API is implemented in terms of the new API to avoid code duplication.</p>
<p>Here is an example about the transition from API_LEVEL 1 to 2. The transition from 2 to 3 and similar is analogous.</p>
<p>Unconditionally:</p><ul>
<li>the new API is defined in sub-namespace <code>api_v2</code></li>
</ul>
<p>If API_LEVEL is 2:</p><ul>
<li><code>api_v2</code> namespace is inlined into the <code>seastar</code> namespace</li>
</ul>
<p>If API_LEVEL is 1:</p><ul>
<li>the old API is defined in sub-namespace <code>api_v1</code></li>
<li><code>api_v1</code> is implemented in terms of <code>api_v2</code> to prevent code duplication</li>
<li><code>api_v1</code> namespace is inlined into the <code>seastar</code> namespace</li>
</ul>
<p>After a transition period:</p><ul>
<li>everthing in <code>api_v1</code> is dropped</li>
<li><code>api_v2</code> is removed, and its contents is placed in the parent namespace </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
